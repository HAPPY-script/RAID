game.StarterGui:SetCore("SendNotification", {
    Title = "CẢNH BÁO !",
    Text = "Chỉ nên BẬT RAID trong KHU VỰC RAID, nếu không sẽ gây LAG !",
    Duration = 15,
})
game.StarterGui:SetCore("SendNotification", {
    Title = "WARNING !",
    Text = "Only ENABLE RAID in RAID ARENA, otherwise it will cause LAG !",
    Duration = 15,
})

local ScreenGui = Instance.new("ScreenGui")
local MenuFrame = Instance.new("Frame")
local CloseButton = Instance.new("TextButton")
local RaidButton = Instance.new("TextButton")
local NotificationFrame = Instance.new("Frame")
local NotificationTitle = Instance.new("TextLabel")

local isRaiding = false
local killRadius = 3000
local raidInterval = 5 -- Thời gian mỗi lần kill (giây)
local lastRaidTime = 0 -- Lưu thời gian lần raid trước

ScreenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")

-- Menu chính
MenuFrame.Size = UDim2.new(0, 250, 0, 120)
MenuFrame.Position = UDim2.new(0, 10, 0, 10)
MenuFrame.BackgroundColor3 = Color3.fromRGB(139, 69, 19) -- Màu nâu
MenuFrame.BackgroundTransparency = 0.2
MenuFrame.Active = true
MenuFrame.Draggable = true
MenuFrame.Parent = ScreenGui

CloseButton.Size = UDim2.new(0, 30, 0, 30)
CloseButton.Position = UDim2.new(0, 5, 0, 5)
CloseButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
CloseButton.Text = "X"
CloseButton.Parent = MenuFrame

RaidButton.Size = UDim2.new(0, 150, 0, 50)
RaidButton.Position = UDim2.new(0, 50, 0, 50)
RaidButton.BackgroundColor3 = Color3.fromRGB(255, 215, 0)
RaidButton.Text = "Raid"
RaidButton.Parent = MenuFrame

-- Thông báo ở góc phải
NotificationFrame.Size = UDim2.new(0, 200, 0, 50)
NotificationFrame.Position = UDim2.new(1, -210, 1, -60)
NotificationFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
NotificationFrame.BackgroundTransparency = 0.5
NotificationFrame.Visible = false
NotificationFrame.Parent = ScreenGui

NotificationTitle.Size = UDim2.new(1, 0, 1, 0)
NotificationTitle.Text = "Raid in progress"
NotificationTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
NotificationTitle.BackgroundTransparency = 1
NotificationTitle.Font = Enum.Font.SourceSansBold
NotificationTitle.TextScaled = true
NotificationTitle.Parent = NotificationFrame

CloseButton.MouseButton1Click:Connect(function()
    ScreenGui:Destroy()
end)

-- Hàm tìm và tiêu diệt NPC
local function killNPCs()
    local player = game.Players.LocalPlayer
    local character = player.Character or player.CharacterAdded:Wait()
    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")

    local npcsInRange = {}

    -- Lọc các NPC hoặc quái vật có Humanoid trong bán kính 3000m
    for _, npc in pairs(workspace:GetDescendants()) do
        if npc:IsA("Model") and npc:FindFirstChild("Humanoid") and npc:FindFirstChild("HumanoidRootPart") then
            local humanoid = npc:FindFirstChild("Humanoid")
            local npcRootPart = npc:FindFirstChild("HumanoidRootPart")

            -- Kiểm tra khoảng cách và bỏ qua chính người chơi
            if npcRootPart and humanoidRootPart and npc ~= character then
                local distance = (humanoidRootPart.Position - npcRootPart.Position).Magnitude
                if distance <= killRadius and humanoid.Health > 0 then
                    table.insert(npcsInRange, npc)
                end
            end
        end
    end

    -- Kill tối đa 8 NPC gần nhất
    for i = 1, math.min(8, #npcsInRange) do
        local npc = npcsInRange[i]
        local humanoid = npc:FindFirstChild("Humanoid")
        if humanoid and humanoid.Health > 0 then
            humanoid.Health = 0 -- Giết quái vật ngay lập tức
        end
    end
end

local raidLoop

RaidButton.MouseButton1Click:Connect(function()
    if isRaiding then
        -- Dừng Raid
        isRaiding = false
        RaidButton.Text = "Raid"
        NotificationFrame.Visible = false
        if raidLoop then
            raidLoop:Disconnect()
        end
    else
        -- Bắt đầu Raid
        isRaiding = true
        RaidButton.Text = "Stop"
        NotificationFrame.Visible = true

        raidLoop = game:GetService("RunService").Stepped:Connect(function()
            if isRaiding and (tick() - lastRaidTime >= raidInterval) then
                lastRaidTime = tick() -- Cập nhật thời gian raid
                killNPCs()
            end
        end)
    end
end)
